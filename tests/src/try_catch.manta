// examples/try_catch.manta

// ReadFile is the return type for the read_file function
type ReadFile enum {
    Ok(str)
    IOError
}

// read_file reads the file at the given path
fn read_file(path str) ReadFile {
    try .Ok(f) := open(path) catch { return .IOError }
    defer { close(f) }

    try .Ok(s) := read_to_string(f) catch { return .IOError }
    return .Ok(s)
}

// entry point for the program
fn main() {
    try .Ok(content) := read_file("/tmp/x.txt") catch (e) {
        print("read failed: ", e)
        return
    }
    print(content)

    // a try can become a simple panic if it has a trailing !
    try .Ok(content) := read_file("/tmp/missing.txt") !
}
